{"ast":null,"code":"import _classCallCheck from \"/Users/geekh04/workspace/BCP/bcp-transactionMDP-client/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/geekh04/workspace/BCP/bcp-transactionMDP-client/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/geekh04/workspace/BCP/bcp-transactionMDP-client/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/geekh04/workspace/BCP/bcp-transactionMDP-client/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/geekh04/workspace/BCP/bcp-transactionMDP-client/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _assertThisInitialized from \"/Users/geekh04/workspace/BCP/bcp-transactionMDP-client/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nvar _jsxFileName = \"/Users/geekh04/workspace/BCP/bcp-transactionMDP-client/src/views/User/Transfer/TransfersTable3.jsx\";\nimport React from \"react\";\nimport { Link } from \"react-router-dom\";\nimport _ from \"lodash\";\nimport { makeData } from \"./Utils\"; // Import React Table\n\nimport ReactTable from \"react-table\"; //import \"react-table/react-table.css\";\n\nimport \"../../../assets/css/react-table.css\"; // reactstrap components\n\nimport { Card, CardHeader, CardBody, CardTitle, Table, Row, Col, Button } from \"reactstrap\";\nimport { connect } from \"react-redux\";\nimport { getCurrentUser } from \"../../../redux/actions\"; // Sweet alert\n\nimport Swal from \"sweetalert2\";\nimport withReactContent from \"sweetalert2-react-content\";\nimport { TRANSFER_LIST_SIZE } from \"../../../variables/constants\";\nimport { getAllTransfers, cancelTransfer, acceptTransfer, sendTransfer } from \"../../../util/APIUtils\";\nimport NotFound from \"./TransferPage\";\nimport { formatDateTime } from \"../../../util/Helpers\";\nimport LoadingIndicator from \"../../../components/LoadingIndicator/LoadingIndicator\";\nvar MySwal = withReactContent(Swal); //const rawData = makeData();\n\nvar requestData = function requestData(transfers, pageSize, page, sorted, filtered) {\n  return new Promise(function (resolve, reject) {\n    // You can retrieve your data however you want, in this case, we will just use some local data.\n    var filteredData = makeData(transfers); // You can use the filters in your request, but you are responsible for applying them.\n\n    if (filtered.length) {\n      filteredData = filtered.reduce(function (filteredSoFar, nextFilter) {\n        return filteredSoFar.filter(function (row) {\n          return (row[nextFilter.id] + \"\").includes(nextFilter.value);\n        });\n      }, filteredData);\n    } // You can also use the sorting in your request, but again, you are responsible for applying it.\n\n\n    var sortedData = _.orderBy(filteredData, sorted.map(function (sort) {\n      return function (row) {\n        if (row[sort.id] === null || row[sort.id] === undefined) {\n          return -Infinity;\n        }\n\n        return typeof row[sort.id] === \"string\" ? row[sort.id].toLowerCase() : row[sort.id];\n      };\n    }), sorted.map(function (d) {\n      return d.desc ? \"desc\" : \"asc\";\n    })); // You must return an object containing the rows of the current page, and optionally the total pages number.\n\n\n    var res = {\n      rows: sortedData.slice(pageSize * page, pageSize * page + pageSize),\n      pages: Math.ceil(filteredData.length / pageSize)\n    }; // Here we'll simulate a server response with 500ms of delay.\n\n    setTimeout(function () {\n      return resolve(res);\n    }, 500);\n  });\n};\n\nvar TransfersTable =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(TransfersTable, _React$Component);\n\n  function TransfersTable(props) {\n    var _this;\n\n    _classCallCheck(this, TransfersTable);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(TransfersTable).call(this, props));\n    _this.state = {\n      transfers: [],\n      page: 0,\n      size: 10,\n      totalElements: 0,\n      totalPages: 0,\n      last: true,\n      isLoadingTransfers: true,\n      data: [],\n      pages: null,\n      loading: true\n    };\n    _this.loadTransfersList = _this.loadTransfersList.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.handleLoadMore = _this.handleLoadMore.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.handleCancelTransfer = _this.handleCancelTransfer.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.handleAcceptTransfer = _this.handleAcceptTransfer.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.handleSendTransfer = _this.handleSendTransfer.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.fetchData = _this.fetchData.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    return _this;\n  }\n\n  _createClass(TransfersTable, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.props.getCurrentUser();\n      /*************************************************/\n      //const username = this.props.match.params.username;\n\n      this.loadTransfersList();\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(nextProps) {\n      /*if(this.props.isAuthenticated !== nextProps.isAuthenticated) {\n        // Reset State\n        this.setState({\n          transfers: [],\n          page: 0,\n          size: 10,\n          totalElements: 0,\n          totalPages: 0,\n          last: true,\n          isLoadingTransfers: false\n        });\n        this.loadTransfersList();\n      }*/\n    }\n  }, {\n    key: \"handleLoadMore\",\n    value: function handleLoadMore() {\n      this.loadTransfersList(this.state.page + 1);\n    }\n  }, {\n    key: \"loadTransfersList\",\n    value: function loadTransfersList() {\n      var _this2 = this;\n\n      var page = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n      var size = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : TRANSFER_LIST_SIZE;\n      var promise;\n      promise = getAllTransfers(); //getUserCreatedTransfers(this.props.currentUser.username, page, size);\n\n      if (!promise) {\n        return;\n      }\n\n      this.setState({\n        isLoadingTransfers: true\n      });\n      promise.then(function (response) {\n        _this2.setState({\n          transfers: response,\n\n          /*response.content\n          page: response.page,\n          size: response.size,\n          totalElements: response.totalElements,\n          totalPages: response.totalPages,\n          last: response.last,*/\n          isLoadingTransfers: false\n        });\n      }).catch(function (error) {\n        _this2.setState({\n          isLoadingTransfers: false\n        });\n      });\n    }\n  }, {\n    key: \"handleCancelTransfer\",\n    value: function handleCancelTransfer(id) {\n      var _this3 = this;\n\n      MySwal.fire({\n        buttonsStyling: false,\n        customClass: {\n          confirmButton: 'btn btn-success',\n          cancelButton: 'btn btn-danger'\n        },\n        title: 'Entrer votre motif',\n        input: 'textarea',\n        inputPlaceholder: 'Votre motif ...',\n        showCancelButton: true,\n        confirmButtonText: 'Confirmer',\n        cancelButtonText: 'Annuler'\n      }).then(function (result) {\n        if (result.value) {\n          var reason = result.value;\n          cancelTransfer(id, reason).then(function (response) {\n            /*return */\n            MySwal.fire({\n              type: 'success',\n              title: 'Votre operation a été enregistrée',\n              showConfirmButton: false,\n              timer: 1500\n            });\n\n            _this3.loadTransfersList();\n          }).catch(function (error) {\n            if (error.status === 401) {\n              MySwal.fire({\n                type: 'error',\n                title: 'Vous avez été déconnecté. Veuillez vous connecter pour effectuer cette opération.',\n                showConfirmButton: false,\n                timer: 1500\n              });\n\n              _this3.props.history.push('/login');\n            } else {\n              MySwal.fire({\n                type: 'warning',\n                title: error.message || 'Pardon! Quelque chose s\\'est mal passé. Veuillez réessayer!',\n                showConfirmButton: false,\n                timer: 1500\n              });\n            }\n          });\n        }\n      });\n    }\n  }, {\n    key: \"handleAcceptTransfer\",\n    value: function handleAcceptTransfer(id) {\n      var _this4 = this;\n\n      acceptTransfer(id).then(function (response) {\n        /*return */\n        MySwal.fire({\n          type: 'success',\n          title: 'Votre operation a été enregistrée',\n          showConfirmButton: false,\n          timer: 1500\n        });\n\n        _this4.loadTransfersList();\n      }).catch(function (error) {\n        if (error.status === 401) {\n          MySwal.fire({\n            type: 'error',\n            title: 'Vous avez été déconnecté. Veuillez vous connecter pour effectuer cette opération.',\n            showConfirmButton: false,\n            timer: 1500\n          });\n\n          _this4.props.history.push('/login');\n        } else {\n          MySwal.fire({\n            type: 'warning',\n            title: error.message || 'Pardon! Quelque chose s\\'est mal passé. Veuillez réessayer!',\n            showConfirmButton: false,\n            timer: 1500\n          });\n        }\n      });\n    }\n  }, {\n    key: \"handleSendTransfer\",\n    value: function handleSendTransfer(id) {\n      var _this5 = this;\n\n      sendTransfer(id).then(function (response) {\n        /*return */\n        MySwal.fire({\n          type: 'success',\n          title: 'Votre operation a été enregistrée',\n          showConfirmButton: false,\n          timer: 1500\n        });\n\n        _this5.loadTransfersList();\n      }).catch(function (error) {\n        if (error.status === 401) {\n          MySwal.fire({\n            type: 'error',\n            title: 'Vous avez été déconnecté. Veuillez vous connecter pour effectuer cette opération.',\n            showConfirmButton: false,\n            timer: 1500\n          });\n\n          _this5.props.history.push('/login');\n        } else {\n          MySwal.fire({\n            type: 'warning',\n            title: error.message || 'Pardon! Quelque chose s\\'est mal passé. Veuillez réessayer!',\n            showConfirmButton: false,\n            timer: 1500\n          });\n        }\n      });\n    }\n  }, {\n    key: \"renderSwitch\",\n    value: function renderSwitch(state, link) {\n      switch (state) {\n        case 'accepted':\n          return React.createElement(React.Fragment, null, React.createElement(Link, {\n            to: link,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 291\n            },\n            __self: this\n          }, React.createElement(Button, {\n            className: \"btn-link\",\n            color: \"success\",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 291\n            },\n            __self: this\n          }, \"Valid\\xE9e\")), \" \", React.createElement(Button, {\n            className: \"btn-icon btn-simple\",\n            onClick: this.handleCancelTransfer,\n            style: {\n              border: 0\n            },\n            color: \"primary\",\n            size: \"sm\",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 292\n            },\n            __self: this\n          }, React.createElement(\"i\", {\n            className: \"fa fa-times\",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 293\n            },\n            __self: this\n          })));\n\n        case 'in_progress':\n          return React.createElement(React.Fragment, null, React.createElement(Link, {\n            to: link,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 297\n            },\n            __self: this\n          }, React.createElement(Button, {\n            className: \"btn-link\",\n            color: \"warning\",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 297\n            },\n            __self: this\n          }, \"Encours\")), \" \", React.createElement(Button, {\n            className: \"btn-icon btn-simple\",\n            onClick: this.handleCancelTransfer,\n            style: {\n              border: 0\n            },\n            color: \"primary\",\n            size: \"sm\",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 298\n            },\n            __self: this\n          }, React.createElement(\"i\", {\n            className: \"fa fa-times\",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 299\n            },\n            __self: this\n          })));\n\n        case 'cancelled':\n          return React.createElement(React.Fragment, null, React.createElement(Link, {\n            to: link,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 303\n            },\n            __self: this\n          }, React.createElement(Button, {\n            className: \"btn-link\",\n            color: \"danger\",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 303\n            },\n            __self: this\n          }, \"Rejet\\xE9e\")), \" \", React.createElement(Button, {\n            className: \"btn-icon btn-simple\",\n            onClick: this.handleCancelTransfer,\n            style: {\n              border: 0\n            },\n            color: \"primary\",\n            size: \"sm\",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 304\n            },\n            __self: this\n          }, React.createElement(\"i\", {\n            className: \"fa fa-times\",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 305\n            },\n            __self: this\n          })));\n\n        default:\n          return null;\n      }\n    }\n  }, {\n    key: \"renderBtnCTN\",\n    value: function renderBtnCTN(link) {\n      return React.createElement(React.Fragment, null, React.createElement(Button, {\n        className: \"btn-icon btn-simple\",\n        onClick: this.handleAcceptTransfer,\n        style: {\n          border: 0\n        },\n        color: \"primary\",\n        size: \"sm\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 316\n        },\n        __self: this\n      }, React.createElement(\"i\", {\n        className: \"fa fa-check\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 317\n        },\n        __self: this\n      })), \" \", React.createElement(Button, {\n        className: \"btn-icon btn-simple\",\n        onClick: this.handleCancelTransfer,\n        style: {\n          border: 0\n        },\n        color: \"primary\",\n        size: \"sm\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 319\n        },\n        __self: this\n      }, React.createElement(\"i\", {\n        className: \"fa fa-times\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 320\n        },\n        __self: this\n      })), \" \", React.createElement(Link, {\n        to: link,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 322\n        },\n        __self: this\n      }, React.createElement(Button, {\n        className: \"btn-icon btn-simple\",\n        style: {\n          border: 0\n        },\n        color: \"primary\",\n        size: \"sm\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 322\n        },\n        __self: this\n      }, React.createElement(\"i\", {\n        className: \"fa fa-eye\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 323\n        },\n        __self: this\n      }))));\n    }\n  }, {\n    key: \"renderBtnCTRL\",\n    value: function renderBtnCTRL(link) {\n      return React.createElement(React.Fragment, null, this.renderBtnCTN(link), \" \", React.createElement(Button, {\n        className: \"btn-icon btn-simple\",\n        onClick: this.handleSendTransfer,\n        style: {\n          border: 0\n        },\n        color: \"primary\",\n        size: \"sm\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 334\n        },\n        __self: this\n      }, React.createElement(\"i\", {\n        className: \"fa fa-paper-plane\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 335\n        },\n        __self: this\n      })));\n    }\n  }, {\n    key: \"fetchData\",\n    value: function fetchData(state, instance) {\n      var _this6 = this;\n\n      // Whenever the table model changes, or the user sorts or changes pages, this method gets called and passed the current table model.\n      // You can set the `loading` prop of the table to true to use the built-in one or show you're own loading bar if you want.\n      this.setState({\n        loading: true\n      }); // Request the data however you want.  Here, we'll use our mocked service we created earlier\n\n      console.log(state.transfers);\n      requestData(state.transfers, state.pageSize, state.page, state.sorted, state.filtered).then(function (res) {\n        // Now just get the rows of data to your React Table (and update anything else like total pages or loading)\n        _this6.setState({\n          data: res.rows,\n          pages: res.pages,\n          loading: false\n        });\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$state = this.state,\n          isLoadingTransfers = _this$state.isLoadingTransfers,\n          transfers = _this$state.transfers,\n          data = _this$state.data,\n          pages = _this$state.pages,\n          loading = _this$state.loading;\n\n      if (isLoadingTransfers) {\n        return React.createElement(LoadingIndicator, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 367\n          },\n          __self: this\n        });\n      }\n\n      if (this.state.notFound || !this.props.currentUser) {\n        return React.createElement(NotFound, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 371\n          },\n          __self: this\n        });\n      }\n      /*if(this.state.serverError) {\n        return <ServerError />;\n      }*/\n\n\n      return React.createElement(React.Fragment, null, React.createElement(\"div\", {\n        className: \"content\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 379\n        },\n        __self: this\n      }, React.createElement(Row, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 380\n        },\n        __self: this\n      }, React.createElement(Col, {\n        md: \"12\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 381\n        },\n        __self: this\n      }, React.createElement(Card, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 382\n        },\n        __self: this\n      }, React.createElement(CardHeader, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 383\n        },\n        __self: this\n      }, React.createElement(CardTitle, {\n        tag: \"h4\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 384\n        },\n        __self: this\n      }, \"Mes virements\")), React.createElement(CardBody, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 386\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 404\n        },\n        __self: this\n      }, React.createElement(ReactTable, {\n        columns: [{\n          Header: \"Référence\",\n          id: \"ref\",\n          accessor: function accessor(d) {\n            return d.reference;\n          }\n        }, {\n          Header: \"Date d'opération\",\n          accessor: \"executionDate\"\n        }, {\n          Header: \"Donneur d’ordre\",\n          accessor: \"principalAccount\"\n        }, {\n          Header: \"Bénéficiaire\",\n          accessor: \"beneficiaryAccount\"\n        }, {\n          Header: \"Montant\",\n          accessor: \"totalAmount\"\n        }, {\n          Header: \"Etat/Action\",\n          accessor: \"stateAction\"\n        }],\n        manual: true // Forces table not to paginate or sort automatically, so we can handle it server-side\n        ,\n        data: transfers,\n        pages: pages // Display the total number of pages\n        ,\n        loading: loading // Display the loading overlay when we need it\n        ,\n        onFetchData: this.fetchData // Request new data when things change\n        ,\n        filterable: true,\n        defaultPageSize: 10,\n        className: \"-striped -highlight\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 405\n        },\n        __self: this\n      }))))))));\n    }\n  }]);\n\n  return TransfersTable;\n}(React.Component);\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return {\n    currentUser: state.currentUser\n  };\n};\n\nexport default connect(mapStateToProps, {\n  getCurrentUser: getCurrentUser\n})(TransfersTable);","map":{"version":3,"sources":["/Users/geekh04/workspace/BCP/bcp-transactionMDP-client/src/views/User/Transfer/TransfersTable3.jsx"],"names":["React","Link","_","makeData","ReactTable","Card","CardHeader","CardBody","CardTitle","Table","Row","Col","Button","connect","getCurrentUser","Swal","withReactContent","TRANSFER_LIST_SIZE","getAllTransfers","cancelTransfer","acceptTransfer","sendTransfer","NotFound","formatDateTime","LoadingIndicator","MySwal","requestData","transfers","pageSize","page","sorted","filtered","Promise","resolve","reject","filteredData","length","reduce","filteredSoFar","nextFilter","filter","row","id","includes","value","sortedData","orderBy","map","sort","undefined","Infinity","toLowerCase","d","desc","res","rows","slice","pages","Math","ceil","setTimeout","TransfersTable","props","state","size","totalElements","totalPages","last","isLoadingTransfers","data","loading","loadTransfersList","bind","handleLoadMore","handleCancelTransfer","handleAcceptTransfer","handleSendTransfer","fetchData","nextProps","promise","setState","then","response","catch","error","fire","buttonsStyling","customClass","confirmButton","cancelButton","title","input","inputPlaceholder","showCancelButton","confirmButtonText","cancelButtonText","result","reason","type","showConfirmButton","timer","status","history","push","message","link","border","renderBtnCTN","instance","console","log","notFound","currentUser","Header","accessor","reference","Component","mapStateToProps"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport { Link } from \"react-router-dom\";\n\n\nimport _ from \"lodash\";\nimport { makeData } from \"./Utils\";\n\n// Import React Table\nimport ReactTable from \"react-table\";\n//import \"react-table/react-table.css\";\nimport \"../../../assets/css/react-table.css\";\n\n\n\n\n\n\n// reactstrap components\nimport {\n  Card,\n  CardHeader,\n  CardBody,\n  CardTitle,\n  Table,\n  Row,\n  Col,\n  Button\n} from \"reactstrap\";\n\nimport { connect } from \"react-redux\";\nimport { getCurrentUser } from \"../../../redux/actions\";\n// Sweet alert\nimport Swal from \"sweetalert2\";\nimport withReactContent from \"sweetalert2-react-content\";\n\nimport {TRANSFER_LIST_SIZE} from \"../../../variables/constants\";\nimport { getAllTransfers, cancelTransfer, acceptTransfer, sendTransfer} from \"../../../util/APIUtils\";\nimport NotFound from \"./TransferPage\";\nimport {formatDateTime} from \"../../../util/Helpers\";\nimport LoadingIndicator from \"../../../components/LoadingIndicator/LoadingIndicator\";\n\n\nconst MySwal = withReactContent(Swal);\n\n\n//const rawData = makeData();\n\nconst requestData = (transfers,pageSize, page, sorted, filtered) => {\n  return new Promise((resolve, reject) => {\n    // You can retrieve your data however you want, in this case, we will just use some local data.\n    let filteredData = makeData(transfers);\n\n    // You can use the filters in your request, but you are responsible for applying them.\n    if (filtered.length) {\n      filteredData = filtered.reduce((filteredSoFar, nextFilter) => {\n        return filteredSoFar.filter(row => {\n          return (row[nextFilter.id] + \"\").includes(nextFilter.value);\n        });\n      }, filteredData);\n    }\n    // You can also use the sorting in your request, but again, you are responsible for applying it.\n    const sortedData = _.orderBy(\n        filteredData,\n        sorted.map(sort => {\n          return row => {\n            if (row[sort.id] === null || row[sort.id] === undefined) {\n              return -Infinity;\n            }\n            return typeof row[sort.id] === \"string\"\n                ? row[sort.id].toLowerCase()\n                : row[sort.id];\n          };\n        }),\n        sorted.map(d => (d.desc ? \"desc\" : \"asc\"))\n    );\n\n    // You must return an object containing the rows of the current page, and optionally the total pages number.\n    const res = {\n      rows: sortedData.slice(pageSize * page, pageSize * page + pageSize),\n      pages: Math.ceil(filteredData.length / pageSize)\n    };\n\n    // Here we'll simulate a server response with 500ms of delay.\n    setTimeout(() => resolve(res), 500);\n  });\n};\n\n\nclass TransfersTable extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      transfers: [],\n      page: 0,\n      size: 10,\n      totalElements: 0,\n      totalPages: 0,\n      last: true,\n      isLoadingTransfers: true,\n\n\n\n\n\n      data: [],\n      pages: null,\n      loading: true\n    };\n    this.loadTransfersList = this.loadTransfersList.bind(this);\n    this.handleLoadMore = this.handleLoadMore.bind(this);\n    this.handleCancelTransfer = this.handleCancelTransfer.bind(this);\n    this.handleAcceptTransfer = this.handleAcceptTransfer.bind(this);\n    this.handleSendTransfer = this.handleSendTransfer.bind(this);\n\n\n    this.fetchData = this.fetchData.bind(this);\n  }\n\n  componentDidMount() {\n    this.props.getCurrentUser();\n    /*************************************************/\n    //const username = this.props.match.params.username;\n    this.loadTransfersList();\n  }\n\n  componentDidUpdate(nextProps) {\n    /*if(this.props.isAuthenticated !== nextProps.isAuthenticated) {\n      // Reset State\n      this.setState({\n        transfers: [],\n        page: 0,\n        size: 10,\n        totalElements: 0,\n        totalPages: 0,\n        last: true,\n        isLoadingTransfers: false\n      });\n      this.loadTransfersList();\n    }*/\n  }\n\n  handleLoadMore() {\n    this.loadTransfersList(this.state.page + 1);\n  }\n\n  loadTransfersList(page = 0, size = TRANSFER_LIST_SIZE) {\n    let promise;\n\n    promise = getAllTransfers();//getUserCreatedTransfers(this.props.currentUser.username, page, size);\n\n    if(!promise) {\n      return;\n    }\n\n    this.setState({\n      isLoadingTransfers: true\n    });\n\n    promise\n        .then(response => {\n          this.setState({\n            transfers: response,/*response.content\n            page: response.page,\n            size: response.size,\n            totalElements: response.totalElements,\n            totalPages: response.totalPages,\n            last: response.last,*/\n            isLoadingTransfers: false\n          })\n        }).catch(error => {\n      this.setState({\n        isLoadingTransfers: false\n      })\n    });\n\n  }\n\n  handleCancelTransfer(id) {\n    MySwal.fire({\n      buttonsStyling:false,\n      customClass: {\n        confirmButton: 'btn btn-success',\n        cancelButton: 'btn btn-danger',\n      },\n      title: 'Entrer votre motif',\n      input: 'textarea',\n      inputPlaceholder: 'Votre motif ...',\n      showCancelButton: true,\n      confirmButtonText: 'Confirmer',\n      cancelButtonText: 'Annuler'\n    }).then((result) => {\n      if (result.value) {\n        let reason = result.value;\n        cancelTransfer(id, reason)\n            .then(response => {\n\n              /*return */MySwal.fire({\n                type: 'success',\n                title: 'Votre operation a été enregistrée',\n                showConfirmButton: false,\n                timer: 1500\n              });\n              this.loadTransfersList();\n            }).catch(error => {\n          if(error.status === 401) {\n            MySwal.fire({\n              type: 'error',\n              title: 'Vous avez été déconnecté. Veuillez vous connecter pour effectuer cette opération.',\n              showConfirmButton: false,\n              timer: 1500\n            });\n            this.props.history.push('/login');\n          } else {\n            MySwal.fire({\n              type: 'warning',\n              title: error.message || 'Pardon! Quelque chose s\\'est mal passé. Veuillez réessayer!',\n              showConfirmButton: false,\n              timer: 1500\n            })\n          }\n        });\n      }\n    })\n  }\n\n  handleAcceptTransfer(id) {\n    acceptTransfer(id)\n        .then(response => {\n\n          /*return */MySwal.fire({\n            type: 'success',\n            title: 'Votre operation a été enregistrée',\n            showConfirmButton: false,\n            timer: 1500\n          });\n          this.loadTransfersList();\n        }).catch(error => {\n      if(error.status === 401) {\n        MySwal.fire({\n          type: 'error',\n          title: 'Vous avez été déconnecté. Veuillez vous connecter pour effectuer cette opération.',\n          showConfirmButton: false,\n          timer: 1500\n        });\n        this.props.history.push('/login');\n      } else {\n        MySwal.fire({\n          type: 'warning',\n          title: error.message || 'Pardon! Quelque chose s\\'est mal passé. Veuillez réessayer!',\n          showConfirmButton: false,\n          timer: 1500\n        });\n      }\n    });\n  }\n\n  handleSendTransfer(id) {\n    sendTransfer(id)\n        .then(response => {\n\n          /*return */MySwal.fire({\n            type: 'success',\n            title: 'Votre operation a été enregistrée',\n            showConfirmButton: false,\n            timer: 1500\n          });\n          this.loadTransfersList();\n        }).catch(error => {\n      if(error.status === 401) {\n        MySwal.fire({\n          type: 'error',\n          title: 'Vous avez été déconnecté. Veuillez vous connecter pour effectuer cette opération.',\n          showConfirmButton: false,\n          timer: 1500\n        });\n        this.props.history.push('/login');\n      } else {\n        MySwal.fire({\n          type: 'warning',\n          title: error.message || 'Pardon! Quelque chose s\\'est mal passé. Veuillez réessayer!',\n          showConfirmButton: false,\n          timer: 1500\n        });\n      }\n    });\n  }\n\n  renderSwitch(state, link) {\n    switch(state) {\n      case 'accepted':\n        return <><Link to={link}><Button className=\"btn-link\" color=\"success\">Validée</Button></Link>\n          {` `}<Button className=\"btn-icon btn-simple\" onClick={this.handleCancelTransfer} style={{border:0}} color=\"primary\" size=\"sm\">\n            <i className=\"fa fa-times\" />\n          </Button>\n        </>;\n      case 'in_progress':\n        return <><Link to={link}><Button className=\"btn-link\" color=\"warning\">Encours</Button></Link>\n              {` `}<Button className=\"btn-icon btn-simple\" onClick={this.handleCancelTransfer} style={{border:0}} color=\"primary\" size=\"sm\">\n                <i className=\"fa fa-times\" />\n              </Button>\n            </>;\n      case 'cancelled':\n        return <><Link to={link}><Button className=\"btn-link\" color=\"danger\">Rejetée</Button></Link>\n          {` `}<Button className=\"btn-icon btn-simple\" onClick={this.handleCancelTransfer} style={{border:0}} color=\"primary\" size=\"sm\">\n          <i className=\"fa fa-times\" />\n        </Button>\n        </>;\n      default:\n        return null;\n    }\n  }\n\n  renderBtnCTN(link) {\n    return(\n        <>\n          <Button className=\"btn-icon btn-simple\" onClick={this.handleAcceptTransfer} style={{border:0}} color=\"primary\" size=\"sm\">\n            <i className=\"fa fa-check\"></i>\n          </Button>{` `}\n          <Button className=\"btn-icon btn-simple\" onClick={this.handleCancelTransfer} style={{border:0}} color=\"primary\" size=\"sm\">\n            <i className=\"fa fa-times\" />\n          </Button>{` `}\n          <Link to={link}><Button className=\"btn-icon btn-simple\" style={{border:0}} color=\"primary\" size=\"sm\">\n            <i className=\"fa fa-eye\"></i>\n          </Button></Link>\n        </>\n    );\n  }\n\n  renderBtnCTRL(link) {\n    return(\n        <>\n          {this.renderBtnCTN(link)}\n          {` `}\n          <Button className=\"btn-icon btn-simple\" onClick={this.handleSendTransfer} style={{border:0}} color=\"primary\" size=\"sm\">\n            <i className=\"fa fa-paper-plane\"></i>\n          </Button>\n        </>\n    );\n  }\n\n  fetchData(state, instance) {\n    // Whenever the table model changes, or the user sorts or changes pages, this method gets called and passed the current table model.\n    // You can set the `loading` prop of the table to true to use the built-in one or show you're own loading bar if you want.\n    this.setState({ loading: true });\n    // Request the data however you want.  Here, we'll use our mocked service we created earlier\n    console.log(state.transfers);\n    requestData(\n        state.transfers,\n        state.pageSize,\n        state.page,\n        state.sorted,\n        state.filtered\n    ).then(res => {\n      // Now just get the rows of data to your React Table (and update anything else like total pages or loading)\n      this.setState({\n        data: res.rows,\n        pages: res.pages,\n        loading: false\n      });\n    });\n  }\n\n  render() {\n    const { isLoadingTransfers, transfers, data, pages, loading } = this.state;\n\n    if(isLoadingTransfers) {\n      return <LoadingIndicator />;\n    }\n\n    if(this.state.notFound || !this.props.currentUser) {\n      return <NotFound />;\n    }\n\n    /*if(this.state.serverError) {\n      return <ServerError />;\n    }*/\n    return (\n        <>\n          <div className=\"content\">\n            <Row>\n              <Col md=\"12\">\n                <Card>\n                  <CardHeader>\n                    <CardTitle tag=\"h4\">Mes virements</CardTitle>\n                  </CardHeader>\n                  <CardBody>\n                    {/*\n                      {transfers.map((transfer, key) => {\n                        return (\n                            <tr key={key}>\n                              <td>{transfer.ref}</td>\n                              <td>{formatDateTime(transfer.executionDate)}</td>\n                              <td>{transfer.principalAccount}</td>\n                              <td>{transfer.beneficiaryAccount}</td>\n                              <td className=\"text-center\">{transfer.transaction}</td>\n                              <td className=\"text-center\">\n                                {this.props.currentUser.role===\"ROLE_AGENT\"?this.renderSwitch(transfer.state,\"/user/transfers/\"+transfer.id):null}\n                                {this.props.currentUser.role===\"ROLE_CTN\"?this.renderBtnCTN(\"/user/transfers/\"+transfer.id):null}\n                                {this.props.currentUser.role===\"ROLE_CTRL\"?this.renderBtnCTRL(\"/user/transfers/\"+transfer.id):null}\n                              </td>\n                            </tr>\n                        );\n                      })}*/}\n                    <div>\n                      <ReactTable\n                          columns={[\n                            {\n                              Header: \"Référence\",\n                              id: \"ref\",\n                              accessor: d => d.reference\n                            },\n                            {\n                              Header: \"Date d'opération\",\n                              accessor: \"executionDate\"\n                            },\n                            {\n                              Header: \"Donneur d’ordre\",\n                              accessor: \"principalAccount\"\n                            },\n                            {\n                              Header: \"Bénéficiaire\",\n                              accessor: \"beneficiaryAccount\"\n                            },\n                            {\n                              Header: \"Montant\",\n                              accessor: \"totalAmount\"\n                            },\n                            {\n                              Header: \"Etat/Action\",\n                              accessor: \"stateAction\"\n                            },\n                          ]}\n                          manual // Forces table not to paginate or sort automatically, so we can handle it server-side\n                          data={transfers}\n                          pages={pages} // Display the total number of pages\n                          loading={loading} // Display the loading overlay when we need it\n                          onFetchData={this.fetchData} // Request new data when things change\n                          filterable\n                          defaultPageSize={10}\n                          className=\"-striped -highlight\"\n                      />\n                    </div>\n                  </CardBody>\n                </Card>\n              </Col>\n            </Row>\n          </div>\n        </>\n    );\n  }\n}\n\nconst mapStateToProps = (state) =>{\n  return {\n    currentUser: state.currentUser\n  };\n};\n\nexport default connect(mapStateToProps, { getCurrentUser })(TransfersTable);\n"]},"metadata":{},"sourceType":"module"}